import{C as m}from"./index-BhysBmqz.js";document.addEventListener("DOMContentLoaded",function(){document.getElementById("validate-btn").addEventListener("click",p)});async function p(){const a=document.getElementById("validation-upload").files[0];if(!a||a.type!=="application/pdf"){alert("Please upload a PDF file");return}const n=document.getElementById("loading-overlay");n.classList.remove("hidden"),n.style.display="flex";try{const d=await a.arrayBuffer(),c=m.lib.WordArray.create(d),t=m.SHA256(c).toString(),o=new FormData;o.append("pdf",a),o.append("hash",t);const i=await fetch("./verify_document.php",{method:"POST",body:o});if(!i.ok)throw new Error("Verification request failed");const l=await i.json();u(l)}catch(d){console.error("Validation error:",d),alert("Error validating document. Please try again."),u({valid:!1})}finally{n.classList.add("hidden"),n.style.display="none"}}function r(e){return e?new Date(e).toLocaleString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"}):"Not available"}function u(e){const a=document.getElementById("result-card"),n=document.getElementById("status-icon"),d=document.getElementById("result-title");a.style.display="block",a.className="result-card "+(e.valid?"valid":"invalid"),n.textContent=e.valid?"✓":"✗",n.className=e.valid?"text-green-600":"text-red-600",d.textContent=e.valid?"Document is authentic":"Document validation failed",d.className="text-xl font-semibold "+(e.valid?"text-green-800":"text-red-800");const c={document:["doc-filename","doc-status","doc-upload-date","doc-signed-date","doc-due-date","doc-requirements","doc-hash"],sender:["sender-name","sender-position","sender-faculty"],recipient:["recipient-name","recipient-position","recipient-faculty"]},t=(i,l)=>{const s=document.getElementById(i);s&&(s.textContent=l||"Not available")};e.valid&&e.metadata?(t("doc-filename",e.metadata.document.original_filename),t("doc-status",e.metadata.document.status.toUpperCase()),t("doc-upload-date",r(e.metadata.document.upload_date)),t("doc-signed-date",r(e.metadata.document.signed_at)),t("doc-due-date",r(e.metadata.document.due_date)),t("doc-requirements",e.metadata.document.requirements||"None specified"),t("doc-hash",e.metadata.hash),t("sender-name",e.metadata.sender.name),t("sender-position",e.metadata.sender.position),t("sender-faculty",e.metadata.sender.faculty),t("recipient-name",e.metadata.recipient.name),t("recipient-position",e.metadata.recipient.position),t("recipient-faculty",e.metadata.recipient.faculty)):Object.values(c).flat().forEach(i=>{t(i,"")});const o=document.getElementById("validation-upload");o.value=""}
